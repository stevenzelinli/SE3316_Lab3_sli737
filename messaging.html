<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Messaging Board</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
    $(document).ready(function() {
      $("h1").text("Best Messaging Board");
      //LOADING SE3316
      $.getJSON("https://lab3-sli737-wulios.c9users.io/api/messages/SE3316", function(data) {
        data.sort(function(a, b) {
          return b.timestamp - a.timestamp;
        });
        $("#SE3316").children("li").each(function(index) {
          $(this).text(data[index].content + " : " + (new Date(parseInt(data[index].timestamp))).toLocaleString());
        });
      });
      //LOADING SE3352
      $.getJSON("https://lab3-sli737-wulios.c9users.io/api/messages/SE3352", function(data) {
        data.sort(function(a, b) {
          return b.timestamp - a.timestamp;
        });
        $("#SE3352").children("li").each(function(index) {
          $(this).text(data[index].content + " : " + (new Date(parseInt(data[index].timestamp))).toLocaleString());
        });
      });

      //SETTING REFRESH RATE OF MESSAGES
      setInterval(function() {
        //UPDATING SE3316
        $.getJSON("https://lab3-sli737-wulios.c9users.io/api/messages/SE3316", function(data) {
          data.sort(function(a, b) {
            return b.timestamp - a.timestamp;
          });
          $("#SE3316").children("li").each(function(index) {
            $(this).text(data[index].content + " : " + (new Date(parseInt(data[index].timestamp))).toLocaleString());
          });
        });
        //UPDATING SE3352
        $.getJSON("https://lab3-sli737-wulios.c9users.io/api/messages/SE3352", function(data) {
          data.sort(function(a, b) {
            return b.timestamp - a.timestamp;
          });
          $("#SE3352").children("li").each(function(index) {
            $(this).text(data[index].content + " : " + (new Date(parseInt(data[index].timestamp))).toLocaleString());
          });
        });

      }, 1000);

      //SETTING EVENT LISTENERS
      //3316 SEND BOX
      $("#3316").click(function() {
        if ($("#3316msg").val().length < 200) {
          var query = "course=SE3316&" + $("#3316msg").serialize();
          $.post("https://lab3-sli737-wulios.c9users.io/api/messages", query);
          $("#3316msg").val("");
        }
        else {
          alert("Max Char : 200");
          $("#3316msg").val("");
        }
      });
      //3352 SEND BOX
      $("#3352").click(function() {
        if ($("#3352msg").val().length < 200) {
          var query = "course=SE3352&" + $("#3352msg").serialize();
          $.post("https://lab3-sli737-wulios.c9users.io/api/messages", query);
          $("#3352msg").val("");
        }
        else {
          alert("Max Char : 200");
          $("#3352msg").val("");
        }
      });
    });
  </script>
</head>

<body>
  <h1>
    Message Board
  </h1>
  <h2>
    SE3316
  </h2>
  <ol id="SE3316">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
  </ol>
  <input type="text" id="3316msg" value="Message" name="content" /><button type="button" id="3316">Send</button>
  <h2>
    SE3352
  </h2>
  <ol id="SE3352">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
  </ol>
  <input type="text" id="3352msg" value="Message" name="content" /><button type="button" id="3352">Send</button>
</body>

</html>